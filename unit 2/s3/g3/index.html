<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
</head>
<body>
    
    <div class="container d-flex justify-content-end my-3">
        <button class="btn btn-danger" type="button" data-bs-toggle="offcanvas" data-bs-target="#staticBackdrop" aria-controls="staticBackdrop">
            Cart
        </button>
        <div class="offcanvas offcanvas-end" data-bs-backdrop="static" tabindex="-1" id="staticBackdrop" aria-labelledby="staticBackdropLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="staticBackdropLabel">Your Products</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
                <div>
                    <ul id="cart-list">

                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="row" id="div-row">

        </div>
    </div>

    <script src="./node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script>

        fetch('https://striveschool-api.herokuapp.com/books')
        .then(res => res.json())
        .then(books => {
            books.forEach(el => {
                let rowDiv = document.querySelector('#div-row')
                //div col
                let col = document.createElement('div')
                col.classList.add('col-12', 'col-sm-6', 'col-md-4', 'col-lg-3')
                rowDiv.append(col)

                //card
                let card = document.createElement('div')
                card.classList.add('card', 'my-2')
                col.append(card)

                //card img
                let img = document.createElement('img')
                img.classList.add('card-img-top')
                img.src = el.img
                card.append(img)

                //card body
                let body = document.createElement('div')
                body.classList.add('card-body')
                card.append(body)

                //body elements
                let title = document.createElement('h5')
                title.classList.add('card-title')
                title.innerText = el.title
                body.append(title)

                let price = document.createElement('p')
                price.classList.add('card-text')
                price.innerText = `Price: ${el.price}$`
                body.append(price)

                let category = document.createElement('p')
                category.classList.add('card-text')
                category.innerText = `Category: ${el.category}`
                body.append(category)

                //button to remove col
                let deleteBtn = document.createElement('button')
                deleteBtn.classList.add('btn', 'btn-primary')
                deleteBtn.innerText = 'Remove'
                body.append(deleteBtn)

                //button to add product to cart
                let addBtn = document.createElement('button')
                addBtn.classList.add('btn', 'btn-success', 'mx-1')
                addBtn.innerText = 'Buy'
                body.append(addBtn)

                // function to remove col
                deleteBtn.addEventListener('click', () => col.remove())

                //function to add product to cart
                addBtn.addEventListener('click', () => {
                    let cart = document.querySelector('#cart-list')
                    let product = document.createElement('li')
                    product.innerText = `${el.title}, ${el.price}$`
                    cart.append(product)
                    localStorage.setItem('product', el.title)
                    let removeBtn = document.createElement('button')
                    removeBtn.classList.add('btn', 'btn-secondary', 'mx-1')
                    removeBtn.innerText = 'Remove'
                    product.append(removeBtn)
                    //function to remove product in the cart
                    removeBtn.addEventListener('click', () => {
                        product.remove()
                        localStorage.removeItem('product')
                    })
                })
            });
        })

    </script>
</body>
</html>